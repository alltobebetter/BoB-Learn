# locals和globals

在 Python 中，`locals()` 和 `globals()` 都是内置函数，用于访问当前作用域的变量。它们分别返回一个字典，表示局部和全局命名空间。

**1. locals()**

* **功能：** 返回当前作用域的局部变量及其值的字典。局部作用域指的是函数内部、`with` 语句块内部或 `comprehension` 内部等。
* **返回值：** 一个字典，键为局部变量名（字符串），值为对应的变量值。
* **特点：**
    * **动态性：** `locals()` 返回的是当前局部命名空间的快照，对其修改**不会**影响实际的局部变量。这意味着你不能通过修改 `locals()` 返回的字典来改变变量的值。  例如：

    ```python
    def my_function():
        x = 10
        local_vars = locals()
        local_vars['x'] = 20
        print(x)  # 输出 10，x 的值并没有改变
        print(local_vars['x']) # 输出 20，字典的值改变了，但不影响变量 x
    my_function()
    ```
    * **只读性（在某些情况下）：** 在函数内部直接调用 `locals()`，返回的字典是**只读**的。尝试修改它会导致错误（在 Python 的某些版本或实现中）。但是，在某些交互式环境（例如 IPython）或调试器中，`locals()` 返回的字典可能是可修改的。
    * **作用域依赖：** `locals()` 的内容取决于调用它的地方。在不同的作用域中调用 `locals()`，返回的字典内容不同。


**2. globals()**

* **功能：** 返回当前模块的全局变量及其值的字典。全局作用域指的是模块级别。
* **返回值：** 一个字典，键为全局变量名（字符串），值为对应的变量值。
* **特点：**
    * **可修改性：** `globals()` 返回的字典是**可修改**的。通过修改 `globals()` 返回的字典，可以**直接改变全局变量的值**。例如：

    ```python
    y = 30
    global_vars = globals()
    global_vars['y'] = 40
    print(y)  # 输出 40，y 的值被修改了
    ```

    * **全局作用域：**  `globals()` 始终返回当前模块的全局命名空间，无论在哪个作用域中调用它。
    * **谨慎使用：** 修改全局变量可能会导致代码难以理解和维护，应谨慎使用。


**总结：**

| 特性      | locals()                      | globals()                     |
|-----------|-------------------------------|-------------------------------|
| 作用域    | 当前局部作用域               | 当前模块的全局作用域            |
| 返回值    | 局部变量字典                 | 全局变量字典                 |
| 可修改性  | 通常只读，修改字典不影响变量 | 可修改，修改字典影响变量     |
| 用途      | 主要用于调试和自省           | 谨慎使用，可用于动态创建全局变量 |


**示例:**

```python
def my_function():
    a = 1
    b = 2
    print("Locals:", locals())
    print("Globals:", globals())

x = 100  # 全局变量

my_function()

print("Globals outside function:", globals())
```


**应用场景**

`locals()` 主要用于调试和自省，例如在日志中打印局部变量的值，或者在调试器中检查变量状态。  `globals()`  较少使用，一个可能的应用场景是动态创建全局变量，但这通常不是推荐的做法。  更常见的是，使用 `globals()` 来访问全局变量的值。
